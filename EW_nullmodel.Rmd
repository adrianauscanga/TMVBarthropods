---
title: "E-W structure using null models"
output: html_notebook
---

In a null model, empirical data are compared to simulated data using the function oecosimu. The presence-absence matrix (explained in diversity.Rmd) is used to calculate beta diversity. I made two groups representing eastern and western mountains. Since there are 7 mountains, 34 combinations of eastern-western mountains different than the real one can exist. After making two groups of mountains in 34 possible combinations, data are randomized between the two groups. This way, 34 randomized groups are compared with the actual E-W structure we are testing. | Se comparan los datos empíricos con datos simulados con la función oecosimu. Se usa la base de datos de presencia-ausencia construida para calcular la diversidad beta. Hice dos grupos que representan montañas del Este y montañas del Oeste. Debido a que hay 7 montañas, existen 34 posibles combinaciones de agrupamientos E-O. Después de hacer dos grupos de montañas con las 34 posibles combinaciones, los datos fueron aleatorizados entre los dos grupos. De esta manera, los 34 grupos aleatorios son comárados con el agrupamiento que representa la estructura E-O que se está poniendo a prueba.

```{r}
library(vegan)
#Group1: E=An,Bl,To W=Aj,Iz,Ma,Pe
E1<-OTUs.PA[1:3,] # vector E
E1<-colSums(E1) #Add all species from these 3 mountains
W1<-OTUs.PA[4:7,] #vector W
W1<-colSums(W1)
EW1<-matrix(data=(c(E1,W1)),nrow=2,ncol=45,byrow=T,dimnames=list(c("E1","W1"))) #Build matrix E-W
EW1
sim1st<-oecosimu(EW1,nestedbetasor,method="r0",nsimul=999) #randomize sites
dplot1st<-densityplot(sim1st, par.strip.text=list(cex=1.3),lwd=2,obs.line("red"),par.settings=list(par.xlab.text=lis(cex=1.5), par.ylab.text=list(cex=1.5)))
dplot1st
```

Repeat with other 34 combinations | Se repite el mismo procedimiento con los otros 34 agrupamientos de montañas.

###Analysis of variance with permutations

Use the same presence-absence matrix | Se usa la misma matriz de presencia-ausencia de OTUs
Group1: W=An,Bl,To E=Aj,Iz,Ma,Pe
```{r}
OTUsdist<-betadiver(OTUs.PA,method=1)
vec1<-c(rep("W",3),rep("E",4)) #E-W vector
AV1<-adonis(OTUsdist~as.factor(vec1),permutation=999)
AV1
```

Repeat with all the other 34 combinations. | Se repite con los otros 34 agrupamientos de montañas 
